Based on https://github.com/CenPC434/validation commit eac78abb6bda628be1e5f3a3853ca8163f0427fd
